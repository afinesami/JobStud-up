jQuery(function(e){e(".wp-job-manager-file-upload").each(function(){e(this).fileupload({dataType:"json",dropZone:e(this),url:job_manager_ajax_file_upload.ajax_url.toString().replace("%%endpoint%%","upload_file"),maxNumberOfFiles:1,formData:{script:!0},add:function(a,t){var i=e(this),n=i.closest("form"),r=i.parents().find(".job-manager-uploaded-files"),l=[],o=e(this).data("file_types");if(o){var d=new RegExp("(.|/)("+o+")$","i");t.originalFiles[0].name.length&&!d.test(t.originalFiles[0].name)&&l.push(job_manager_ajax_file_upload.i18n_invalid_file_type+" "+o)}l.length>0?alert(l.join("\n")):(n.find(':input[type="submit"]').attr("disabled","disabled"),t.context=e('<progress value="" max="100"></progress>').appendTo(r),t.submit())},progress:function(a,t){var i=e(this),n=(i.parent().find(".job-manager-uploaded-files"),parseInt(t.loaded/t.total*100,10));t.context.val(n)},fail:function(a,t){var i=e(this),n=i.closest("form");n.find(':input[type="submit"]').removeAttr("disabled")},done:function(a,t){var i=e(this),n=i.closest("form"),r=i.parent().find(".job-manager-uploaded-files"),l=i.attr("multiple")?1:0,o=["jpg","gif","png","jpeg","jpe"];t.context.remove(),e.each(t.result.files,function(a,t){if(t.error)alert(t.error);else{if(e.inArray(t.extension,o)>=0){var n=e.parseHTML(job_manager_ajax_file_upload.js_field_html_img);e(n).find(".job-manager-uploaded-file-preview img").attr("src",t.url)}else{var n=e.parseHTML(job_manager_ajax_file_upload.js_field_html);e(n).find(".job-manager-uploaded-file-name code").text(t.name)}e(n).find(".input-text").val(t.url),e(n).find(".input-text").attr("name","current_"+i.attr("name")),l?r.append(n):r.html(n)}}),n.find(':input[type="submit"]').removeAttr("disabled")}})})});